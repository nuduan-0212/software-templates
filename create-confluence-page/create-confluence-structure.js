const axios = require('axios');

const baseUrl = 'https://confluence.jitsinnovationlabs.com';
const username = 'anhdn';
const password = 'admin2025'; 

const auth = {
  username,
  password,
};

async function main() {
  const spaceKey = 'BACKSTAGE';
  const spaceName = 'Backstage Integration Space';

  // 1. T·∫°o Space n·∫øu ch∆∞a c√≥
  try {
    await axios.post(`${baseUrl}/rest/api/space`, {
      key: spaceKey,
      name: spaceName,
      description: { plain: { value: 'Backstage Space', representation: 'plain' } }
    }, { auth });
    console.log(`‚úÖ Created space: ${spaceKey}`);
  } catch (err) {
    console.warn(`‚ö†Ô∏è Space may already exist: ${err.response?.status}`);
  }

  // 2. T·∫°o Pages trong Space
  const pages = ['Overview', 'Architecture', 'API Docs', 'How to Deploy'];
  for (const title of pages) {
    await axios.post(`${baseUrl}/rest/api/content`, {
      type: 'page',
      title,
      space: { key: spaceKey },
      body: {
        storage: {
          value: `<h1>${title}</h1><p>Generated by Backstage</p>`,
          representation: 'storage',
        },
      },
    }, { auth });

    console.log(`üìù Created page: ${title}`);
  }
}

main().catch(console.error);
 